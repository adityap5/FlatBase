import{a as y,o as u,r as o,j as e,J as f}from"./main-JNmrs9IS.js";import{a as c}from"./axios-B4uVmeYG.js";import{B as g}from"./Button-Df3aqLW4.js";function k(){const i=y(),{id:r}=u(),[t,l]=o.useState(null),[j,d]=o.useState(!0),m=async()=>{const a=document.createElement("script");a.src="https://checkout.razorpay.com/v1/checkout.js",a.async=!0,document.body.appendChild(a)};o.useEffect(()=>{const a=async()=>{const{data:s}=await f(r);l(s),d(!1)};m(),a()},[r]);const h=async()=>{if(!t)return;const a=localStorage.getItem("token");try{const{data:s}=await c.post("https://flatbase.onrender.com/api/bookings/create-order",{amount:t.totalPrice+999+Math.round(t.totalPrice/t.timePeriod)},{headers:{Authorization:`Bearer ${a}`}}),x={key:"rzp_test_POjN4Ulq8Q6my8",amount:s.amount,currency:s.currency,name:"Flat Booking",description:"Booking Payment",order_id:s.id,handler:async p=>{try{(await c.post("https://flatbase.onrender.com/api/bookings/verify-payment",{...p,bookingId:t._id},{headers:{Authorization:`Bearer ${a}`}})).data.success?i("/success"):alert("Payment Verification Failed!")}catch(n){console.error("Payment verification failed",n)}},theme:{color:"#3399cc"}};new window.Razorpay(x).open()}catch(s){console.error("Payment failed",s)}};return e.jsx("div",{children:e.jsx("div",{className:"grid-cols-3 relative mt-10",children:t&&e.jsx("div",{className:"px-5 sticky bg-white top-0 h-auto mt-5 lg:mt-0 shadow-lg rounded-lg",children:e.jsxs("div",{className:"border-0 rounded-lg px-6 py-4",children:[e.jsx("h2",{className:"text-2xl font-bold text-gray-800 mb-4",children:"Price Details"}),e.jsx("hr",{className:"mb-4"}),e.jsxs("div",{className:"space-y-4 text-lg mb-6",children:[e.jsxs("div",{className:"flex justify-between items-center",children:[e.jsxs("span",{className:"text-gray-600",children:["Price for ",t.timePeriod," month",t.timePeriod>1?"s":""]}),e.jsxs("span",{className:"font-semibold",children:["₹",t.totalPrice.toLocaleString()]})]}),e.jsxs("div",{className:"flex justify-between items-center",children:[e.jsx("span",{className:"text-gray-600",children:"Security Deposit"}),e.jsx("span",{className:"font-semibold",children:"₹999"})]}),e.jsxs("div",{className:"flex justify-between items-center",children:[e.jsx("span",{className:"text-gray-600",children:"Advance Payment"}),e.jsxs("span",{className:"font-semibold",children:["₹",Math.round(t.totalPrice/t.timePeriod).toLocaleString()]})]})]}),e.jsx("hr",{className:"mb-4"}),e.jsxs("div",{className:"flex items-center justify-between py-3 text-xl font-bold",children:[e.jsxs("div",{children:[e.jsx("span",{className:"text-gray-800",children:"Total Charge"}),e.jsx("p",{className:"text-xs font-normal text-gray-500",children:"(Total Price + Advance + Security Deposit)"})]}),e.jsxs("span",{className:"text-green-600",children:["₹",(t.totalPrice+999+Math.round(t.totalPrice/t.timePeriod)).toLocaleString()]})]}),e.jsx(g,{variant:"contained",className:"w-full mt-6",sx:{py:"0.75rem",backgroundColor:"#76ABAE",fontSize:"1.25rem",fontWeight:"bold","&:hover":{backgroundColor:"#5B8D91"}},onClick:h,children:"Proceed to Pay"})]})})})})}export{k as default};
